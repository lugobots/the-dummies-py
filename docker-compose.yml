# DO NOT EDIT THIS FILE
#
# This file is compatible with Lugo Studio.
# If you change it, you may make it incompatible or Lugo Studio may not work correctly.
version: '3.9'
services:
  game_server:
    image: lugobots/server:${SERVER_VERSION:-latest}
    command: play --dev-mode --listening-duration=${LISTENING_DURATION:-50ms} --grpc-port=${GAME_GRPC_PORT:-5000} --timer-mode=${TIMER_MODE:-wait}
    ports:
      - "${GAME_GRPC_PORT:-5000}:${GAME_GRPC_PORT:-5000}"
      - "8080:8080"
    healthcheck:
      test: [ "CMD", "grpc-health-probe", "-addr=game_server:${GAME_GRPC_PORT:-5000}" ]
      interval: 300ms
      timeout: 5s
      retries: 100
      start_period: 10s
    depends_on:
      builder:
        condition: service_completed_successfully
    environment:
      - HOME_TEAM_NAME=${HOME_TEAM_NAME:-HOME}
      - AWAY_TEAM_NAME=${AWAY_TEAM_NAME:-AWAY}
  builder:
    image: bot_watcher
    build:
      context: .
      dockerfile: .lugo/builder.Dockerfile
    working_dir: /app
    volumes:
      -  ${PROJECT_PATH:-./}:/app

  player_home_01:
    image: bot_watcher
    command: ["nodemon", "-L", "--config", ".lugo/nodemon.json"]
    working_dir: /usr/src/app
    volumes:
      - ${PROJECT_PATH:-./}:/usr/src/app
    depends_on:
        game_server:
          condition: service_healthy
        builder:
          condition: service_completed_successfully
    environment:
      - BOT_NUMBER=1
      - BOT_TEAM=${PLAYER_SIDE:-home}
      - BOT_GRPC_URL=game_server:${GAME_GRPC_PORT:-5000}

  player_home_02:
    image: bot_watcher
    command: ["nodemon", "-L", "--config", ".lugo/nodemon.json"]
    working_dir: /usr/src/app
    volumes:
      - ${PROJECT_PATH:-./}:/usr/src/app
    depends_on:
        game_server:
          condition: service_healthy
        builder:
          condition: service_completed_successfully
    environment:
      - BOT_NUMBER=2
      - BOT_TEAM=${PLAYER_SIDE:-home}
      - BOT_GRPC_URL=game_server:${GAME_GRPC_PORT:-5000}
  player_home_03:
    image: bot_watcher
    command: ["nodemon", "-L", "--config", ".lugo/nodemon.json"]
    working_dir: /usr/src/app
    volumes:
      - ${PROJECT_PATH:-./}:/usr/src/app
    depends_on:
        game_server:
          condition: service_healthy
        builder:
          condition: service_completed_successfully
    environment:
      - BOT_NUMBER=3
      - BOT_TEAM=${PLAYER_SIDE:-home}
      - BOT_GRPC_URL=game_server:${GAME_GRPC_PORT:-5000}

  player_home_04:
    image: bot_watcher
    command: ["nodemon", "-L", "--config", ".lugo/nodemon.json"]
    working_dir: /usr/src/app
    volumes:
      - ${PROJECT_PATH:-./}:/usr/src/app
    depends_on:
        game_server:
          condition: service_healthy
        builder:
          condition: service_completed_successfully
    environment:
      - BOT_NUMBER=4
      - BOT_TEAM=${PLAYER_SIDE:-home}
      - BOT_GRPC_URL=game_server:${GAME_GRPC_PORT:-5000}

  player_home_05:
    image: bot_watcher
    command: ["nodemon", "-L", "--config", ".lugo/nodemon.json"]
    working_dir: /usr/src/app
    volumes:
      - ${PROJECT_PATH:-./}:/usr/src/app
    depends_on:
        game_server:
          condition: service_healthy
        builder:
          condition: service_completed_successfully
    environment:
      - BOT_NUMBER=5
      - BOT_TEAM=${PLAYER_SIDE:-home}
      - BOT_GRPC_URL=game_server:${GAME_GRPC_PORT:-5000}

  player_home_06:
    image: bot_watcher
    command: ["nodemon", "-L", "--config", ".lugo/nodemon.json"]
    working_dir: /usr/src/app
    volumes:
      - ${PROJECT_PATH:-./}:/usr/src/app
    depends_on:
        game_server:
          condition: service_healthy
        builder:
          condition: service_completed_successfully
    environment:
      - BOT_NUMBER=6
      - BOT_TEAM=${PLAYER_SIDE:-home}
      - BOT_GRPC_URL=game_server:${GAME_GRPC_PORT:-5000}

  player_home_07:
    image: bot_watcher
    command: ["nodemon", "-L", "--config", ".lugo/nodemon.json"]
    working_dir: /usr/src/app
    volumes:
      - ${PROJECT_PATH:-./}:/usr/src/app
    depends_on:
        game_server:
          condition: service_healthy
        builder:
          condition: service_completed_successfully
    environment:
      - BOT_NUMBER=7
      - BOT_TEAM=${PLAYER_SIDE:-home}
      - BOT_GRPC_URL=game_server:${GAME_GRPC_PORT:-5000}

  player_home_08:
    image: bot_watcher
    command: ["nodemon", "-L", "--config", ".lugo/nodemon.json"]
    working_dir: /usr/src/app
    volumes:
      - ${PROJECT_PATH:-./}:/usr/src/app
    depends_on:
        game_server:
          condition: service_healthy
        builder:
          condition: service_completed_successfully
    environment:
      - BOT_NUMBER=8
      - BOT_TEAM=${PLAYER_SIDE:-home}
      - BOT_GRPC_URL=game_server:${GAME_GRPC_PORT:-5000}

  player_home_09:
    image: bot_watcher
    command: ["nodemon", "-L", "--config", ".lugo/nodemon.json"]
    working_dir: /usr/src/app
    volumes:
      - ${PROJECT_PATH:-./}:/usr/src/app
    depends_on:
        game_server:
          condition: service_healthy
        builder:
          condition: service_completed_successfully
    environment:
      - BOT_NUMBER=9
      - BOT_TEAM=${PLAYER_SIDE:-home}
      - BOT_GRPC_URL=game_server:${GAME_GRPC_PORT:-5000}

  player_home_10:
    image: bot_watcher
    command: ["nodemon", "-L", "--config", ".lugo/nodemon.json"]
    working_dir: /usr/src/app
    volumes:
      - ${PROJECT_PATH:-./}:/usr/src/app
    depends_on:
        game_server:
          condition: service_healthy
        builder:
          condition: service_completed_successfully
    environment:
      - BOT_NUMBER=10
      - BOT_TEAM=${PLAYER_SIDE:-home}
      - BOT_GRPC_URL=game_server:${GAME_GRPC_PORT:-5000}

  player_home_11:
    image: bot_watcher
    command: ["nodemon", "-L", "--config", ".lugo/nodemon.json"]
    working_dir: /usr/src/app
    volumes:
      - ${PROJECT_PATH:-./}:/usr/src/app
    depends_on:
        game_server:
          condition: service_healthy
        builder:
          condition: service_completed_successfully
    environment:
      - BOT_NUMBER=11
      - BOT_TEAM=${PLAYER_SIDE:-home}
      - BOT_GRPC_URL=game_server:${GAME_GRPC_PORT:-5000}

  player_away_01:
    image: ${AWAY_BOT:-lugobots/level-1:latest}
    depends_on:
        game_server:
          condition: service_healthy
        builder:
          condition: service_completed_successfully
    environment:
      - BOT_NUMBER=1
      - BOT_TEAM=${OPPONENT_SIDE:-away}
      - MODE=${MODE:-default} # default zombies statues kids defenses
      - BOT_GRPC_URL=game_server:${GAME_GRPC_PORT:-5000}

  player_away_02:
    image: ${AWAY_BOT:-lugobots/level-1:latest}
    depends_on:
        game_server:
          condition: service_healthy
        builder:
          condition: service_completed_successfully
    environment:
      - BOT_NUMBER=2
      - BOT_TEAM=${OPPONENT_SIDE:-away}
      - MODE=${MODE:-default} # default zombies statues kids defenses
      - BOT_GRPC_URL=game_server:${GAME_GRPC_PORT:-5000}

  player_away_03:
    image: ${AWAY_BOT:-lugobots/level-1:latest}
    depends_on:
        game_server:
          condition: service_healthy
        builder:
          condition: service_completed_successfully
    environment:
      - BOT_NUMBER=3
      - BOT_TEAM=${OPPONENT_SIDE:-away}
      - MODE=${MODE:-default} # default zombies statues kids defenses
      - BOT_GRPC_URL=game_server:${GAME_GRPC_PORT:-5000}
  player_away_04:
    image: ${AWAY_BOT:-lugobots/level-1:latest}
    depends_on:
        game_server:
          condition: service_healthy
        builder:
          condition: service_completed_successfully
    environment:
      - BOT_NUMBER=4
      - BOT_TEAM=${OPPONENT_SIDE:-away}
      - MODE=${MODE:-default} # default zombies statues kids defenses
      - BOT_GRPC_URL=game_server:${GAME_GRPC_PORT:-5000}
  player_away_05:
    image: ${AWAY_BOT:-lugobots/level-1:latest}
    depends_on:
        game_server:
          condition: service_healthy
        builder:
          condition: service_completed_successfully
    environment:
      - BOT_NUMBER=5
      - BOT_TEAM=${OPPONENT_SIDE:-away}
      - MODE=${MODE:-default} # default zombies statues kids defenses
      - BOT_GRPC_URL=game_server:${GAME_GRPC_PORT:-5000}
  player_away_06:
    image: ${AWAY_BOT:-lugobots/level-1:latest}
    depends_on:
        game_server:
          condition: service_healthy
        builder:
          condition: service_completed_successfully
    environment:
      - BOT_NUMBER=6
      - BOT_TEAM=${OPPONENT_SIDE:-away}
      - MODE=${MODE:-default} # default zombies statues kids defenses
      - BOT_GRPC_URL=game_server:${GAME_GRPC_PORT:-5000}
  player_away_07:
    image: ${AWAY_BOT:-lugobots/level-1:latest}
    depends_on:
        game_server:
          condition: service_healthy
        builder:
          condition: service_completed_successfully
    environment:
      - BOT_NUMBER=7
      - BOT_TEAM=${OPPONENT_SIDE:-away}
      - MODE=${MODE:-default} # default zombies statues kids defenses
      - BOT_GRPC_URL=game_server:${GAME_GRPC_PORT:-5000}
  player_away_08:
    image: ${AWAY_BOT:-lugobots/level-1:latest}
    depends_on:
        game_server:
          condition: service_healthy
        builder:
          condition: service_completed_successfully
    environment:
      - BOT_NUMBER=8
      - BOT_TEAM=${OPPONENT_SIDE:-away}
      - MODE=${MODE:-default} # default zombies statues kids defenses
      - BOT_GRPC_URL=game_server:${GAME_GRPC_PORT:-5000}
  player_away_09:
    image: ${AWAY_BOT:-lugobots/level-1:latest}
    depends_on:
        game_server:
          condition: service_healthy
        builder:
          condition: service_completed_successfully
    environment:
      - BOT_NUMBER=9
      - BOT_TEAM=${OPPONENT_SIDE:-away}
      - MODE=${MODE:-default} # default zombies statues kids defenses
      - BOT_GRPC_URL=game_server:${GAME_GRPC_PORT:-5000}
  player_away_10:
    image: ${AWAY_BOT:-lugobots/level-1:latest}
    depends_on:
        game_server:
          condition: service_healthy
        builder:
          condition: service_completed_successfully
    environment:
      - BOT_NUMBER=10
      - BOT_TEAM=${OPPONENT_SIDE:-away}
      - MODE=${MODE:-default} # default zombies statues kids defenses
      - BOT_GRPC_URL=game_server:${GAME_GRPC_PORT:-5000}
  player_away_11:
    image: ${AWAY_BOT:-lugobots/level-1:latest}
    depends_on:
        game_server:
          condition: service_healthy
        builder:
          condition: service_completed_successfully
    environment:
      - BOT_NUMBER=11
      - BOT_TEAM=${OPPONENT_SIDE:-away}
      - MODE=${MODE:-default} # default zombies statues kids defenses
      - BOT_GRPC_URL=game_server:${GAME_GRPC_PORT:-5000}

